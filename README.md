# HOMEWORK4:薛定谔方程
## A.非简谐振子
### 1.数值求解方法
此题为边界问题，要求满足在边界处：
$$\lim_{x \to \infty} \phi(x,t) = 0$$
此外，还要保证波函数的归一化
#### 算法一
为了数值求解，不妨认为存在$L$足够大，使得：
 $$ \phi(L,t) \approx 0 $$ 和 $$\phi(-L,t) \approx 0 $$其中 \( L \) 足够大以覆盖波函数的主要分布范围。
 这是一个本征值问题：只有当 \( E \) 是某些特殊值（本征值）时，这个边值问题才有非零的解（波函数）。
 所以，我们可以使用基于割线法和龙格库塔法结合（打靶法）的思想解决问题：
 1. 首先要利用量子力学的一个结论，对于势函数为偶函数的情况下，基函数、偶数级激发态的波函数为偶函数，奇数级激发态为奇函数。
 2. 将问题转化为初值问题
  猜测一个E的值，我们可以设置初值条件 
  - 基态或者偶数级激发态：\( \psi(0) = 1 \)（或其他非零值，数值计算时不影响归一化）和 \( \psi'(0) = 0 \)。 
  - 奇数级激发态：\( \psi(0) = 0 \) 和 \( \psi'(0) = 1 \)（或其他非零值，数值计算时不影响归一化）
3. 使用数值方法（四阶龙格-库塔法）从 \( x = 0 \) 积分到 \( x = L \)。
4. 检查边界 \( \psi(L) \) 是否接近零。如果结果不满足边界条件，使用割线法调整$E$的值。定义$f(E ) = \psi(L)$，则$$E_{n+1} = E_n - \frac{E_{n}-E_{n+1}}{f(E_n) - f(E_{n-1})}f(E_{n})$$
5. 对于新的E的值，回到步骤2，如此迭代，直到满足边界条件
6. 最后，对于找到的E，得出波函数，对波函数进行归一化处理。

写出相关代码进行数值计算，其中用到的割线法和龙格库塔法已在前面的作业中写过。具体代码实现详见附录。
#### 算法二
此算法同老师上课所讲算法。
1. 选择数值解的区域。该区域应足够大，以确保相较于势函数的有效区域，边界处波函数的影响可忽略不计。（思想同算法一中的L）

2. 对最低本征值提供一个合理的猜测。猜测的初始值应该尽可能接近正确值，可以降低运算时间

3. 积分波函数。

- 从左侧将$\phi_l(x)$从$x=x_l$处积分到$x=x_r+h$  ；

- 从右侧将$\phi_l(x)$从$x=x_r$处积分到$x=x_l-h$；

- 将初始点处的波函数值设为零，并在积分起始点对波函数值进行rescale,确保$\phi_l(x_r)=\phi_r(x_r)$。

4. 计算匹配函数：
$$f(\varepsilon_0)=\frac{[\varphi_r(x_r-h)-\varphi_r(x_r+h)]-[\varphi_l(x_r-h)-\varphi_l(x_r+h)}{2h\varphi_r(x_r)}$$

5. 使用割线法找到 $f(\varepsilon_0)=0$ 的解。通过割线法逐步调整$\varepsilon$的值，直至满足给定的容忍度。

6. 求解下一个本征值。为了找到下一个本征值，可以从一个略高于上一个本征值的起始值开始搜索。(可以通过检查波函数的节点数来判断是否有遗漏的本征能量)
#### 算法三


也可以将[-L,L]的位移x离散化，得到一个矢量$\vec{\phi}(x)$。
将薛定谔方程写成差分的格式：
$$-\frac{\hbar^2}{2m}[\frac{\phi(x_i-\Delta x)-2\phi(x_i)+\phi(x_i+\Delta x)}{{\Delta x}^2}] + V(x)\phi(x) = E\phi(x)$$
得到矩阵形式：
得到矩阵方程

$$\left[\begin{array}{cccccc} A(x_1) & B & 0 & \cdots & 0 \\ B & A(x_2) & B & 0 & \cdots & 0 \\ 0 & B & A(x_3) & B & 0 & \cdots \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \cdots & B & A(x_l) \end{array}\right] \left[\begin{array}{c} \psi(x_1) \\ \psi(x_2) \\ \psi(x_3) \\ \vdots \\ \psi(x_l) \end{array}\right] = 0$$

其中

$$A(x_i) = \frac{\hbar^2}{m\Delta x^2} + V(x_i) - E, B = -\frac{\hbar^2}{2m\Delta x^2}$$

则E为该矩阵的本征值，求本征值即可。


### 2. 计算基态能量
代码见附录，得到的基态能量为0.5594:
![alt text](figure/A_1_1.png)
得到基态波函数的绝对值的图像为：

![figure/A_1_2.png](figure/A_1_2.png)

### 求解1-4激发态的本征能量和波函数

第一激发态到第四激发态的本征能量为：$E_1=1.7705$,$E_2=3.1403$,$E_3=4.6314$,$E_4=6.2237$
![alt text](figure/A_energy.png)
波函数**绝对值**的图像为：
第一激发态：
![alt text](figure/A_chafen_1.png)
第二激发态：
![alt text](figure/A_chafen_2.png)
第三激发态：
![alt text](figure/A_chafen_3.png)
第四激发态：
![alt text](figure/A_chafen_4.png)
### 和简谐振子$v=\frac{1}{2}x^2$的比较
简谐振子$v=\frac{1}{2}x^2$的情况下波函数是有解析解的，对于方程$$-\frac{1}{2}\frac{d^2}{dx^2}\phi(x)+\frac{x^2}{2}\phi(x)=E\phi(x)$$有解析解,
波函数的推导如下：
利用变异系数法，波函数：
$$ \phi(x) = A(x)e^{-\frac{x^2}{2}}$$
其中 $A(x) = \sum_{k=0}^{\infty} a_k x^k$
带入薛定谔方程可以得到：
$$a_{k+2} = \frac{2k+1-2E}{(k+1)(k+2)}a_k$$
可以发现，事实上求和不能加到无穷，否则波函数不收敛，也就是存在$a_n$不为0，$a_{n+2}=0$的情况：$$a_{k+2} = \frac{2k+1-2E}{(k+1)(k+2)}a_k=0$$
即$$E = k+\frac{1}{2}$$
由此得到本征能量的形式：
基态能量为0.5,第一激发态能量为1.5，以此类推。
不妨取$b_0=1,b+1=2$,我们也得到了波函数的解析解：
$$ \phi_i(x) = \sum_{k=0}^{i} \frac{1}{\sqrt{2^kk!\sqrt{\pi}}}e^{-\frac{x^2}{2}}A(x)$$
这里的A(x)的截断取决于本征能量的大小。
